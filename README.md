# Навигатор

Веб-сайт для местного отделения Движения Первых.

## Описание

Навигатор — это веб-платформа, предоставляющая информацию о возможностях участия в Движении Первых, мероприятиях, проектах и контактах местного отделения.

## Технологии

- **HTML/CSS** - Структура и стилизация
- **Node.js** - Серверная среда
- **Express** - Веб-фреймворк
- **EJS** - Шаблонизатор для HTML
- **express-session** - Управление сессиями
- **bcrypt** - Хеширование паролей
- **better-sqlite3** - SQLite база данных

## Структура проекта

```
digital-navigator/
├── app.js                 # Основной файл Express сервера
├── database.js            # Модуль для работы с БД
├── database.db            # SQLite база данных (создается автоматически)
├── package.json           # Зависимости проекта
├── views/                 # EJS шаблоны
│   ├── partials/         # Частичные шаблоны (header, footer)
│   └── pages/            # Страницы сайта
│       ├── home.ejs      # Главная страница
│       ├── faq.ejs       # FAQ страница
│       ├── opportunities.ejs  # Возможности движения
│       ├── participation.ejs  # Местное участие
│       ├── contacts.ejs  # Контакты
│       ├── login.ejs     # Страница входа
│       ├── register.ejs  # Страница регистрации
│       ├── profile.ejs   # Профиль пользователя (личный кабинет)
│       ├── profile-edit.ejs  # Редактирование профиля
│       ├── profile-password.ejs  # Смена пароля
│       ├── admin.ejs     # Админ-панель
│       ├── admin-users.ejs  # Управление пользователями
│       └── error.ejs     # Страница ошибки
├── public/               # Статические файлы
│   ├── css/
│   │   └── style.css    # Стили сайта
│   └── js/
│       └── main.js      # JavaScript функциональность
└── README.md            # Документация
```

## Установка и запуск

### Шаг 1: Установка зависимостей

```bash
npm install
```

Эта команда установит все необходимые пакеты:
- express
- ejs
- body-parser
- express-session
- bcrypt
- better-sqlite3

### Шаг 2: Запуск сервера

#### Обычный запуск:
```bash
npm start
```

#### Запуск с автоматическим перезапуском (рекомендуется для разработки):
```bash
npm run dev
```

#### Использование готовых скриптов:
- **Windows**: запустите `start.bat` (двойной клик или из командной строки)
- **Linux/Mac**: запустите `./start.sh` (предварительно сделайте файл исполняемым: `chmod +x start.sh`)

**Примечание**: При использовании `npm run dev` или скриптов `start.bat`/`start.sh` сервер автоматически перезапустится при изменении файлов `app.js`, `database.js`, шаблонов EJS или CSS.

### Шаг 3: Открытие в браузере

После запуска сервера откройте браузер и перейдите по адресу:

```
http://localhost:3000
```

## Страницы сайта

### Публичные страницы

1. **Главная (/)** - Приветствие, миссия движения, карточки быстрых ссылок
2. **FAQ (/faq)** - Часто задаваемые вопросы с раскрывающимися ответами
3. **Возможности (/opportunities)** - Сетка карточек с различными направлениями деятельности
4. **Участие (/participation)** - Календарь событий, местные проекты, руководители отделения
5. **Контакты (/contacts)** - Информация о координаторе, социальные сети, карта, контактная форма

### Страницы авторизации

6. **Вход (/login)** - Страница входа в систему
7. **Регистрация (/register)** - Страница регистрации нового пользователя

### Защищенные страницы

8. **Профиль (/profile)** - Личный кабинет пользователя (требуется авторизация)
9. **Редактирование профиля (/profile/edit)** - Изменение данных профиля (требуется авторизация)
10. **Смена пароля (/profile/password)** - Изменение пароля (требуется авторизация)
11. **Админ-панель (/admin)** - Панель администратора (требуется роль admin или superadmin)
12. **Управление пользователями (/admin/users)** - Управление пользователями и ролями (только для superadmin)

## Функциональность

### Система авторизации и база данных

Проект включает полноценную систему авторизации с базой данных SQLite и тремя уровнями доступа:

- **user** - Обычный пользователь (базовый доступ)
- **admin** - Администратор (доступ к админ-панели)
- **superadmin** - Супер-администратор (полный доступ, включая управление пользователями)

#### База данных

- Используется SQLite (файл `database.db` создается автоматически)
- Таблица `users` с полями: id, username, email, password, role, first_name, last_name, phone, created_at, updated_at
- Автоматическая инициализация при первом запуске
- Все операции с БД выполняются через модуль `database.js`

#### Тестовые аккаунты

При первом запуске сервера автоматически создаются следующие тестовые аккаунты:

- **Superadmin**: `superadmin` / `superadmin123`
- **Admin**: `admin` / `admin123`
- **User**: `user` / `user123`

#### Особенности

- Пароли хешируются с помощью bcrypt
- Сессии хранятся с использованием express-session
- Регистрация новых пользователей с ролью "user" по умолчанию
- Защита маршрутов с помощью middleware
- Изменение ролей доступно только для superadmin
- Полноценный личный кабинет с возможностью редактирования профиля и смены пароля

### Личный кабинет

Личный кабинет включает:

- Просмотр информации о профиле (имя, email, телефон, роль, дата регистрации)
- Редактирование профиля (изменение username, email, имени, фамилии, телефона)
- Смена пароля (с проверкой текущего пароля)
- Быстрый доступ к админ-панели (для администраторов)

### Контактная форма

Контактная форма на странице `/contacts` отправляет данные методом POST. Данные логируются в консоль сервера. Если пользователь авторизован, также логируется информация о пользователе.

### Адаптивный дизайн

Сайт полностью адаптирован для различных устройств:
- Десктопные компьютеры
- Планшеты
- Мобильные телефоны

### Цветовая схема

Используются официальные цвета Движения Первых:
- Красный (#E31E24) - основной красный
- Синий (#1E50A0) - основной синий
- Белый (#FFFFFF) - фон и акценты

### Иерархия ролей

Система использует иерархию ролей:
- `user` < `admin` < `superadmin`

Superadmin может управлять ролями всех пользователей, admin имеет доступ к админ-панели, обычные пользователи имеют базовый доступ к сайту.

### Регистрация

При регистрации можно указать:
- Имя пользователя (обязательно, уникально)
- Email (обязательно, уникален)
- Пароль (минимум 6 символов)
- Имя (опционально)
- Фамилию (опционально)
- Телефон (опционально)

После успешной регистрации пользователь автоматически входит в систему и перенаправляется в личный кабинет.

## Разработка

Для разработки рекомендуется использовать режим разработки с автоматической перезагрузкой:

```bash
npm run dev
```

Или используйте готовые скрипты:
- **Windows**: `start.bat`
- **Linux/Mac**: `./start.sh`

Сервер автоматически перезапустится при изменении:
- `app.js`
- `database.js`
- Файлов в папке `views/` (EJS шаблоны)
- Файлов в папке `public/` (CSS, JS)

Конфигурация nodemon находится в файле `nodemon.json`.

## Лицензия

ISC
#   j o s k i y _ p e n i s 1  
 